2025-10-30T13:52:11.7753834Z ##[group]Run echo "Waiting for API Gateway and services to be ready..."
2025-10-30T13:52:11.7754807Z [36;1mecho "Waiting for API Gateway and services to be ready..."[0m
2025-10-30T13:52:11.7755764Z [36;1mecho "Giving MySQL containers time to initialize (90 seconds)..."[0m
2025-10-30T13:52:11.7756368Z [36;1msleep 90[0m
2025-10-30T13:52:11.7756675Z [36;1m[0m
2025-10-30T13:52:11.7757084Z [36;1m# Check services via API Gateway (port 80) with retries[0m
2025-10-30T13:52:11.7757604Z [36;1mMAX_RETRIES=10[0m
2025-10-30T13:52:11.7757980Z [36;1mRETRY_DELAY=5[0m
2025-10-30T13:52:11.7758298Z [36;1m[0m
2025-10-30T13:52:11.7758590Z [36;1mcheck_service() {[0m
2025-10-30T13:52:11.7758978Z [36;1m  local service_name=$1[0m
2025-10-30T13:52:11.7759365Z [36;1m  local endpoint=$2[0m
2025-10-30T13:52:11.7759777Z [36;1m  echo "Checking $service_name..."[0m
2025-10-30T13:52:11.7760204Z [36;1m[0m
2025-10-30T13:52:11.7760524Z [36;1m  for i in $(seq 1 $MAX_RETRIES); do[0m
2025-10-30T13:52:11.7760990Z [36;1m    if curl -f "$endpoint"; then[0m
2025-10-30T13:52:11.7761521Z [36;1m      echo "✅ $service_name is healthy"[0m
2025-10-30T13:52:11.7761968Z [36;1m      return 0[0m
2025-10-30T13:52:11.7762296Z [36;1m    fi[0m
2025-10-30T13:52:11.7762826Z [36;1m    echo "⏳ Attempt $i/$MAX_RETRIES failed, retrying in ${RETRY_DELAY}s..."[0m
2025-10-30T13:52:11.7763440Z [36;1m    sleep $RETRY_DELAY[0m
2025-10-30T13:52:11.7763811Z [36;1m  done[0m
2025-10-30T13:52:11.7764111Z [36;1m[0m
2025-10-30T13:52:11.7764463Z [36;1m  echo "❌ $service_name failed to become healthy"[0m
2025-10-30T13:52:11.7764977Z [36;1m  return 1[0m
2025-10-30T13:52:11.7765404Z [36;1m}[0m
2025-10-30T13:52:11.7765683Z [36;1m[0m
2025-10-30T13:52:11.7766233Z [36;1mcheck_service "weight-service" "http://localhost/api/weight/health" || exit 1[0m
2025-10-30T13:52:11.7767162Z [36;1mcheck_service "billing-service" "http://localhost/api/billing/health" || exit 1[0m
2025-10-30T13:52:11.7768074Z [36;1mcheck_service "shift-service" "http://localhost/api/shift/health" || exit 1[0m
2025-10-30T13:52:11.7769172Z [36;1mcheck_service "provider-registration-service" "http://localhost/api/provider/health" || exit 1[0m
2025-10-30T13:52:11.7770103Z [36;1mcheck_service "frontend" "http://localhost/" || exit 1[0m
2025-10-30T13:52:11.7770618Z [36;1m[0m
2025-10-30T13:52:11.7770985Z [36;1mecho "✅ All services healthy via API Gateway"[0m
2025-10-30T13:52:11.7800091Z shell: /usr/bin/bash -e {0}
2025-10-30T13:52:11.7800469Z ##[endgroup]
2025-10-30T13:52:11.7859495Z Waiting for API Gateway and services to be ready...
2025-10-30T13:52:11.7860117Z Giving MySQL containers time to initialize (90 seconds)...
2025-10-30T13:53:41.7898058Z Checking weight-service...
2025-10-30T13:53:41.8076534Z   % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
2025-10-30T13:53:41.8078338Z                                  Dload  Upload   Total   Spent    Left  Speed
2025-10-30T13:53:41.8078982Z 
2025-10-30T13:53:41.8158540Z   0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
2025-10-30T13:53:41.8159579Z 100   127  100   127    0     0  15351      0 --:--:-- --:--:-- --:--:-- 15875
2025-10-30T13:53:41.8169182Z {"status":"healthy","service":"weight-service","version":"2.0.0","database":"healthy","timestamp":"2025-10-30T13:53:41.814926"}✅ weight-service is healthy
2025-10-30T13:53:41.8169837Z Checking billing-service...
2025-10-30T13:53:41.8218059Z   % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
2025-10-30T13:53:41.8218759Z                                  Dload  Upload   Total   Spent    Left  Speed
2025-10-30T13:53:41.8219134Z 
2025-10-30T13:53:41.8241672Z   0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
2025-10-30T13:53:41.8249114Z 100    66  100    66    0     0  27351      0 --:--:-- --:--:-- --:--:-- 33000
2025-10-30T13:53:41.8250092Z {"status":"healthy","service":"billing-service","version":"1.0.0"}✅ billing-service is healthy
2025-10-30T13:53:41.8250710Z Checking shift-service...
2025-10-30T13:53:41.8302130Z   % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
2025-10-30T13:53:41.8302810Z                                  Dload  Upload   Total   Spent    Left  Speed
2025-10-30T13:53:41.8303155Z 
2025-10-30T13:53:41.8327127Z   0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
2025-10-30T13:53:41.8328448Z 100    87  100    87    0     0  34104      0 --:--:-- --:--:-- --:--:-- 43500
2025-10-30T13:53:41.8334515Z {"status":"healthy","service":"Shift Service","version":"1.0.0","database":"connected"}✅ shift-service is healthy
2025-10-30T13:53:41.8335217Z Checking provider-registration-service...
2025-10-30T13:53:41.8382980Z   % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
2025-10-30T13:53:41.8383592Z                                  Dload  Upload   Total   Spent    Left  Speed
2025-10-30T13:53:41.8383900Z 
2025-10-30T13:53:41.8396847Z   0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
2025-10-30T13:53:41.8397446Z <!doctype html>
2025-10-30T13:53:41.8397870Z 100   404  100   404    0     0   295k      0 --:--:-- --:--:-- --:--:--  394k
2025-10-30T13:53:41.8398321Z <html lang="en">
2025-10-30T13:53:41.8398629Z   <head>
2025-10-30T13:53:41.8398953Z     <meta charset="UTF-8" />
2025-10-30T13:53:41.8399429Z     <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
2025-10-30T13:53:41.8400185Z     <meta name="viewport" content="width=device-width, initial-scale=1.0" />
2025-10-30T13:53:41.8400891Z     <title>Gan Shmuel Weight Management</title>
2025-10-30T13:53:41.8401607Z     <script type="module" crossorigin src="/assets/index-hYJkbSLr.js"></script>
2025-10-30T13:53:41.8402168Z   </head>
2025-10-30T13:53:41.8402445Z   <body>
2025-10-30T13:53:41.8402740Z     <div id="root"></div>
2025-10-30T13:53:41.8403054Z   </body>
2025-10-30T13:53:41.8403329Z </html>
2025-10-30T13:53:41.8403848Z ✅ provider-registration-service is healthy
2025-10-30T13:53:41.8404311Z Checking frontend...
2025-10-30T13:53:41.8452409Z   % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
2025-10-30T13:53:41.8453030Z                                  Dload  Upload   Total   Spent    Left  Speed
2025-10-30T13:53:41.8453329Z 
2025-10-30T13:53:41.8463259Z   0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
2025-10-30T13:53:41.8463880Z <!doctype html>
2025-10-30T13:53:41.8464227Z <html lang="en">
2025-10-30T13:53:41.8464547Z   <head>
2025-10-30T13:53:41.8464828Z     <meta charset="UTF-8" />
2025-10-30T13:53:41.8465174Z     <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
2025-10-30T13:53:41.8465848Z     <meta name="viewport" content="width=device-width, initial-scale=1.0" />
2025-10-30T13:53:41.8466276Z     <title>Gan Shmuel Weight Management</title>
2025-10-30T13:53:41.8466689Z     <script type="module" crossorigin src="/assets/index-hYJkbSLr.js"></script>
2025-10-30T13:53:41.8467077Z   </head>
2025-10-30T13:53:41.8467263Z   <body>
2025-10-30T13:53:41.8467499Z     <div id="root"></div>
2025-10-30T13:53:41.8467741Z   </body>
2025-10-30T13:53:41.8467917Z </html>
2025-10-30T13:53:41.8468200Z 100   404  100   404    0     0   358k      0 --:--:-- --:--:-- --:--:--  394k
2025-10-30T13:53:41.8470203Z ✅ frontend is healthy
2025-10-30T13:53:41.8470645Z ✅ All services healthy via API Gateway
